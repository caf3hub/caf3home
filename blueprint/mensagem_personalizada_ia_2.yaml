blueprint:
  name: Notificação Personalizada com IA Generativa
  description: Gera uma mensagem personalizada com IA generativa e envia por um serviço de notificação.
  domain: script
mode: queued
fields:
  mensagem:
    selector:
      text: null
    name: Mensagem
    description: Texto que será utilizado como base para gerar a mensagem personalizada.
    required: true
  notification_target:
    name: Serviço de Notificação
    description: Serviço de notificação que irá enviar a mensagem.
    default: "notify.mqtt_notify"
    selector:
      text:
  prompt:
    name: Prompt
    description: Prompt do generative ai conversation.
    selector:
      multiline:
        rows: 5
      type: text
    default: |-
      Você é a FRIDAY do Homem de Ferro, e uma assistente pessoal da minha casa.
      Voce vai enviar mensagens para o Telegram ou para Alexa.
      Crie uma mensagem única e personalizada, de maneira criativa e variada,
      para informar que: "{{ mensagem }}".
      Varie o estilo da mensagem a cada vez que for gerada.
      Não quero sugestões, mande apenas uma mensagem.
      Não envie "\n" e nem tente fazer quebras de linha assim, nem nada disso pois nao funciona no telegram.
sequence:
  - service: google_generative_ai_conversation.generate_content
    data:
      prompt: |-
        "{{ prompt }}"
    response_variable: mensagem_personalizada
  - delay:
      seconds: 2
  - service: "{{ notification_target }}"
    data:
      message: "{{ mensagem_personalizada['text'] | replace('\n', ' ') }}"
icon: mdi:message